<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Configura√ß√µes - TravelFlow">
  <title>Configura√ß√µes - TravelFlow</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>
  <div class="dashboard-layout">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <a href="dashboard.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">‚úàÔ∏è</div>
          <span class="sidebar-logo-text">TravelFlow</span>
        </a>
      </div>

      <nav class="sidebar-nav">
        <ul class="sidebar-menu">
          <li class="sidebar-menu-item">
            <a href="dashboard.html" class="sidebar-link">
              <span class="sidebar-icon">üìä</span>
              <span>Dashboard</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a href="pacotes.html" class="sidebar-link">
              <span class="sidebar-icon">üì¶</span>
              <span>Pacotes</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a href="clientes.html" class="sidebar-link">
              <span class="sidebar-icon">üë•</span>
              <span>Clientes</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a href="reservas.html" class="sidebar-link">
              <span class="sidebar-icon">üé´</span>
              <span>Reservas</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a href="calendario.html" class="sidebar-link">
              <span class="sidebar-icon">üìÖ</span>
              <span>Calend√°rio</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a href="mensagens.html" class="sidebar-link">
              <span class="sidebar-icon">üí¨</span>
              <span>Mensagens</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a href="relatorios.html" class="sidebar-link">
              <span class="sidebar-icon">üìà</span>
              <span>Relat√≥rios</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a href="configuracoes.html" class="sidebar-link active">
              <span class="sidebar-icon">‚öôÔ∏è</span>
              <span>Configura√ß√µes</span>
            </a>
          </li>
        </ul>
      </nav>

      <div class="sidebar-footer">
        <div class="sidebar-user" id="userInfo">
          <div class="sidebar-user-avatar" id="userAvatar">U</div>
          <div class="sidebar-user-info">
            <span class="sidebar-user-name" id="userName">Usu√°rio</span>
            <span class="sidebar-user-role" id="userRole">Carregando...</span>
          </div>
        </div>
      </div>
    </aside>

    <!-- Overlay para mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Topbar -->
      <header class="topbar">
        <div class="topbar-left">
          <button class="menu-toggle-btn" id="menuToggle" aria-label="Menu">
            ‚ò∞
          </button>
          
          <h2 style="margin: 0; font-size: var(--font-size-xl);">Configura√ß√µes</h2>
        </div>

        <div class="topbar-right">
          <button class="topbar-icon-btn" aria-label="Notifica√ß√µes">
            üîî
            <span class="notification-badge">3</span>
          </button>
          <a href="login.html" class="topbar-icon-btn" aria-label="Sair" title="Sair">
            üö™
          </a>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content-area">
        <div class="settings-container">
          <!-- Perfil -->
          <div class="settings-section">
            <div class="settings-section-header">
              <div class="settings-icon">üë§</div>
              <div>
                <h2 class="settings-section-title">Perfil</h2>
                <p class="settings-section-subtitle">Gerencie suas informa√ß√µes pessoais</p>
              </div>
            </div>

            <div class="profile-avatar-section">
              <div class="profile-avatar-large" id="profileAvatar">U</div>
              <div>
                <h3 id="profileName">Usu√°rio</h3>
                <p style="color: var(--text-secondary); margin-bottom: var(--spacing-md);" id="profileEmail">usuario@email.com</p>
                <button class="btn btn-outline btn-sm" onclick="changeAvatar()">Alterar Foto</button>
              </div>
            </div>

            <form id="profileForm">
              <div class="row">
                <div class="col-6">
                  <div class="form-group">
                    <label class="form-label">Nome Completo</label>
                    <input type="text" class="form-control" id="fullName" placeholder="Seu nome">
                  </div>
                </div>
                <div class="col-6">
                  <div class="form-group">
                    <label class="form-label">E-mail</label>
                    <input type="email" class="form-control" id="email" placeholder="seu@email.com">
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-6">
                  <div class="form-group">
                    <label class="form-label">Telefone</label>
                    <input type="tel" class="form-control" id="phone" placeholder="(11) 99999-9999">
                  </div>
                </div>
                <div class="col-6">
                  <div class="form-group">
                    <label class="form-label">Cargo</label>
                    <input type="text" class="form-control" id="position" placeholder="Gerente">
                  </div>
                </div>
              </div>

              <button type="submit" class="btn btn-primary">Salvar Altera√ß√µes</button>
            </form>
          </div>

          <!-- Seguran√ßa -->
          <div class="settings-section">
            <div class="settings-section-header">
              <div class="settings-icon">üîí</div>
              <div>
                <h2 class="settings-section-title">Seguran√ßa</h2>
                <p class="settings-section-subtitle">Gerencie senha e autentica√ß√£o</p>
              </div>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Alterar Senha</h4>
                <p>√öltima altera√ß√£o: h√° 30 dias</p>
              </div>
              <button class="btn btn-outline btn-sm" onclick="changePassword()">Alterar</button>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Autentica√ß√£o de Dois Fatores</h4>
                <p>Adicione uma camada extra de seguran√ßa</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="twoFactor">
                <span class="toggle-slider"></span>
              </label>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Sess√µes Ativas</h4>
                <p>2 dispositivos conectados</p>
              </div>
              <button class="btn btn-outline btn-sm" onclick="manageSessions()">Gerenciar</button>
            </div>
          </div>

          <!-- Notifica√ß√µes -->
          <div class="settings-section">
            <div class="settings-section-header">
              <div class="settings-icon">üîî</div>
              <div>
                <h2 class="settings-section-title">Notifica√ß√µes</h2>
                <p class="settings-section-subtitle">Configure como deseja ser notificado</p>
              </div>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Notifica√ß√µes por E-mail</h4>
                <p>Receba atualiza√ß√µes importantes por e-mail</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="emailNotif" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Notifica√ß√µes Push</h4>
                <p>Alertas em tempo real no navegador</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="pushNotif" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Resumo Di√°rio</h4>
                <p>Receba um resumo das atividades do dia</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="dailySummary">
                <span class="toggle-slider"></span>
              </label>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Lembretes de Viagens</h4>
                <p>Alertas 7 dias antes das viagens</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="tripReminders" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          <!-- Ag√™ncia -->
          <div class="settings-section">
            <div class="settings-section-header">
              <div class="settings-icon">üè¢</div>
              <div>
                <h2 class="settings-section-title">Informa√ß√µes da Ag√™ncia</h2>
                <p class="settings-section-subtitle">Dados da sua empresa</p>
              </div>
            </div>

            <form id="agencyForm">
              <div class="form-group">
                <label class="form-label">Nome da Ag√™ncia</label>
                <input type="text" class="form-control" id="agencyName" placeholder="TravelFlow Viagens">
              </div>

              <div class="row">
                <div class="col-6">
                  <div class="form-group">
                    <label class="form-label">CNPJ</label>
                    <input type="text" class="form-control" id="cnpj" placeholder="00.000.000/0001-00">
                  </div>
                </div>
                <div class="col-6">
                  <div class="form-group">
                    <label class="form-label">Telefone Comercial</label>
                    <input type="tel" class="form-control" id="businessPhone" placeholder="(11) 3000-0000">
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label class="form-label">Endere√ßo</label>
                <input type="text" class="form-control" id="address" placeholder="Rua, n√∫mero, bairro">
              </div>

              <div class="row">
                <div class="col-6">
                  <div class="form-group">
                    <label class="form-label">Cidade</label>
                    <input type="text" class="form-control" id="city" placeholder="S√£o Paulo">
                  </div>
                </div>
                <div class="col-6">
                  <div class="form-group">
                    <label class="form-label">Estado</label>
                    <select class="form-control" id="state">
                      <option value="">Selecione</option>
                      <option value="SP">S√£o Paulo</option>
                      <option value="RJ">Rio de Janeiro</option>
                      <option value="MG">Minas Gerais</option>
                      <!-- Outros estados -->
                    </select>
                  </div>
                </div>
              </div>

              <button type="submit" class="btn btn-primary">Salvar Altera√ß√µes</button>
            </form>
          </div>

          <!-- Prefer√™ncias -->
          <div class="settings-section">
            <div class="settings-section-header">
              <div class="settings-icon">üé®</div>
              <div>
                <h2 class="settings-section-title">Prefer√™ncias</h2>
                <p class="settings-section-subtitle">Personalize sua experi√™ncia</p>
              </div>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Idioma</h4>
                <p>Portugu√™s (Brasil)</p>
              </div>
              <select class="form-control" style="width: auto;" id="language">
                <option value="pt-BR">Portugu√™s (BR)</option>
                <option value="en">English</option>
                <option value="es">Espa√±ol</option>
              </select>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Fuso Hor√°rio</h4>
                <p>America/Sao_Paulo (GMT-3)</p>
              </div>
              <select class="form-control" style="width: auto;" id="timezone">
                <option value="America/Sao_Paulo">S√£o Paulo (GMT-3)</option>
                <option value="America/New_York">Nova York (GMT-5)</option>
                <option value="Europe/London">Londres (GMT+0)</option>
              </select>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Modo Escuro</h4>
                <p>Ativar tema escuro</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="darkMode">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          <!-- Zona de Perigo -->
          <div class="settings-section danger-zone">
            <div class="settings-section-header">
              <div class="settings-icon" style="background: var(--error-color);">‚ö†Ô∏è</div>
              <div>
                <h2 class="settings-section-title" style="color: var(--error-color);">Zona de Perigo</h2>
                <p class="settings-section-subtitle">A√ß√µes irrevers√≠veis</p>
              </div>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Exportar Dados</h4>
                <p>Baixe todos os seus dados em formato JSON</p>
              </div>
              <button class="btn btn-outline btn-sm" onclick="exportData()">Exportar</button>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Desativar Conta</h4>
                <p>Desative temporariamente sua conta</p>
              </div>
              <button class="btn btn-outline btn-sm" style="color: var(--error-color); border-color: var(--error-color);" onclick="deactivateAccount()">Desativar</button>
            </div>

            <div class="settings-item">
              <div class="settings-item-info">
                <h4>Excluir Conta</h4>
                <p>Exclua permanentemente sua conta e todos os dados</p>
              </div>
              <button class="btn btn-sm" style="background: var(--error-color); color: white;" onclick="deleteAccount()">Excluir Conta</button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    // Verificar autentica√ß√£o
    function checkAuth() {
      const user = localStorage.getItem('travelflow_user');
      if (!user) {
        window.location.href = 'login.html';
        return null;
      }
      return JSON.parse(user);
    }

    // Carregar informa√ß√µes do usu√°rio
    function loadUserInfo() {
      const user = checkAuth();
      if (!user) return;

      const name = user.name || user.email.split('@')[0];
      const initials = name.substring(0, 2).toUpperCase();

      document.getElementById('userName').textContent = name;
      document.getElementById('userRole').textContent = user.role === 'admin' ? 'Administrador' : 'Usu√°rio';
      document.getElementById('userAvatar').textContent = initials;

      // Preencher formul√°rio de perfil
      document.getElementById('profileAvatar').textContent = initials;
      document.getElementById('profileName').textContent = name;
      document.getElementById('profileEmail').textContent = user.email;
      document.getElementById('fullName').value = name;
      document.getElementById('email').value = user.email;
      document.getElementById('phone').value = user.telefone || '';
      
      if (user.agencia) {
        document.getElementById('agencyName').value = user.agencia;
      }
    }

    // Menu Toggle
    const menuToggle = document.getElementById('menuToggle');
    const sidebar = document.getElementById('sidebar');
    const sidebarOverlay = document.getElementById('sidebarOverlay');

    menuToggle.addEventListener('click', () => {
      sidebar.classList.toggle('active');
      sidebarOverlay.classList.toggle('active');
    });

    sidebarOverlay.addEventListener('click', () => {
      sidebar.classList.remove('active');
      sidebarOverlay.classList.remove('active');
    });

    // Salvar perfil
    document.getElementById('profileForm').addEventListener('submit', (e) => {
      e.preventDefault();
      
      const user = checkAuth();
      if (!user) return;

      user.name = document.getElementById('fullName').value;
      user.email = document.getElementById('email').value;
      user.telefone = document.getElementById('phone').value;

      localStorage.setItem('travelflow_user', JSON.stringify(user));
      
      alert('‚úì Perfil atualizado com sucesso!');
      loadUserInfo();
    });

    // Salvar ag√™ncia
    document.getElementById('agencyForm').addEventListener('submit', (e) => {
      e.preventDefault();
      
      const user = checkAuth();
      if (!user) return;

      user.agencia = document.getElementById('agencyName').value;

      localStorage.setItem('travelflow_user', JSON.stringify(user));
      
      alert('‚úì Informa√ß√µes da ag√™ncia atualizadas!');
    });

    // Fun√ß√µes de configura√ß√£o
    function changeAvatar() {
      alert('üì∏ Alterar Foto\n\nEm produ√ß√£o, isso abriria:\n‚Ä¢ Upload de imagem\n‚Ä¢ Crop e ajuste\n‚Ä¢ Preview antes de salvar');
    }

    function changePassword() {
      const currentPassword = prompt('Digite sua senha atual:');
      if (!currentPassword) return;

      const newPassword = prompt('Digite a nova senha (m√≠nimo 8 caracteres):');
      if (!newPassword || newPassword.length < 8) {
        alert('‚ùå A senha deve ter no m√≠nimo 8 caracteres');
        return;
      }

      const confirmPassword = prompt('Confirme a nova senha:');
      if (newPassword !== confirmPassword) {
        alert('‚ùå As senhas n√£o coincidem');
        return;
      }

      alert('‚úì Senha alterada com sucesso!\n\nPor seguran√ßa, voc√™ ser√° redirecionado para fazer login novamente.');
      setTimeout(() => {
        localStorage.removeItem('travelflow_user');
        window.location.href = 'login.html';
      }, 2000);
    }

    function manageSessions() {
      alert('üñ•Ô∏è Sess√µes Ativas\n\n1. Chrome - Windows (atual)\n   S√£o Paulo, Brasil\n   √öltima atividade: agora\n\n2. Safari - iPhone\n   S√£o Paulo, Brasil\n   √öltima atividade: h√° 2 horas\n\n[Encerrar outras sess√µes]');
    }

    function exportData() {
      const user = checkAuth();
      if (!user) return;

      const data = {
        user: user,
        exportDate: new Date().toISOString(),
        version: '1.0'
      };

      alert('üì¶ Exportando dados...\n\nSeus dados ser√£o baixados em formato JSON.\n\nIncluindo:\n‚Ä¢ Dados de perfil\n‚Ä¢ Configura√ß√µes\n‚Ä¢ Hist√≥rico de atividades');
      
      console.log('Dados exportados:', data);
    }

    function deactivateAccount() {
      if (confirm('‚ö†Ô∏è Desativar Conta\n\nTem certeza que deseja desativar sua conta?\n\nVoc√™ poder√° reativ√°-la fazendo login novamente.')) {
        alert('‚úì Conta desativada\n\nSua conta foi desativada temporariamente.\nPara reativar, basta fazer login novamente.');
        localStorage.removeItem('travelflow_user');
        window.location.href = 'login.html';
      }
    }

    function deleteAccount() {
      const confirmation = prompt('‚ö†Ô∏è ATEN√á√ÉO: Esta a√ß√£o √© IRREVERS√çVEL!\n\nTodos os seus dados ser√£o permanentemente exclu√≠dos.\n\nDigite "EXCLUIR" para confirmar:');
      
      if (confirmation === 'EXCLUIR') {
        alert('‚ùå Conta exclu√≠da\n\nSua conta e todos os dados foram permanentemente exclu√≠dos.\n\nSentiremos sua falta!');
        localStorage.removeItem('travelflow_user');
        window.location.href = 'index.html';
      } else if (confirmation) {
        alert('‚ùå Confirma√ß√£o incorreta. Exclus√£o cancelada.');
      }
    }

    // Salvar prefer√™ncias ao mudar toggles
    document.querySelectorAll('.toggle-switch input').forEach(toggle => {
      toggle.addEventListener('change', function() {
        const setting = this.id;
        const value = this.checked;
        console.log(`Configura√ß√£o ${setting} alterada para:`, value);
        
        // Salvar no localStorage
        const settings = JSON.parse(localStorage.getItem('travelflow_settings') || '{}');
        settings[setting] = value;
        localStorage.setItem('travelflow_settings', JSON.stringify(settings));
      });
    });

    // Carregar prefer√™ncias salvas
    function loadSettings() {
      const settings = JSON.parse(localStorage.getItem('travelflow_settings') || '{}');
      
      Object.keys(settings).forEach(key => {
        const element = document.getElementById(key);
        if (element && element.type === 'checkbox') {
          element.checked = settings[key];
        }
      });
    }

    // Logout
    document.querySelectorAll('.topbar-icon-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        if (btn.getAttribute('aria-label') === 'Sair') {
          e.preventDefault();
          if (confirm('Deseja realmente sair?')) {
            localStorage.removeItem('travelflow_user');
            window.location.href = 'login.html';
          }
        }
      });
    });

    // Inicializar
    loadUserInfo();
    loadSettings();
  </script>
</body>
</html>
